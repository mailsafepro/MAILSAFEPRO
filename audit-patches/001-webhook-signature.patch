--- a/app/routes/billing_routes.py
+++ b/app/routes/billing_routes.py
@@ -663,13 +663,22 @@ async def stripe_webhook(
     payload = await request.body()
     sig_header = request.headers.get("stripe-signature")
 
-    # ✅ DESARROLLO: Skip validación de firma
+    # ⚠️ SECURITY FIX: Never skip signature validation
+    # The previous code bypassed signature validation when DOCKER_ENV=1
+    # This was a critical vulnerability allowing forged webhooks
     is_dev = os.getenv("DOCKER_ENV") == "1"
+    is_testing = os.getenv("TESTING") == "1"
 
-    if is_dev:
-        logger.warning("⚠️ DEVELOPMENT MODE: Skipping Stripe signature validation")
+    # Only skip in explicit test mode with TESTING=1, never just DOCKER_ENV
+    if is_testing and not sig_header:
+        logger.warning("⚠️ TEST MODE ONLY: Skipping Stripe signature validation")
         try:
             event = json.loads(payload.decode("utf-8"))
+            # Add explicit marker that this was not validated
+            event["_unvalidated_test_mode"] = True
         except Exception as e:
             logger.error(f"Invalid JSON payload: {e}")
             raise HTTPException(status_code=400, detail="Invalid JSON")
